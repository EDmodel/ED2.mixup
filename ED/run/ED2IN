&ED_NL
!------------------------------------------------------------------------------------------!
! Initial configuration                                                                    !
!------------------------------------------------------------------------------------------!

   NL%EXPNME = 'ED version 2.1 test'   ! Simulation name

   NL%RUNTYPE  = 'INITIAL'   ! Runtype: either INITIAL or HISTORY
                             ! 'INITIAL' - Starts a new run, that can be based on a previous
                             !             run (restart/history), but then it will use.
                             !             the information as a simple initial condition
                             ! 'HISTORY' - Resumes a simulation from the last history.
                             !             This is different from initial in the sense that
                             !             exactly the same information written in the 
                             !             history will be used here.

!----- Start of simulation (RUNTYPE=initial only) -----------------------------------------!
   NL%IMONTHA  = 01  ! Month
   NL%IDATEA   = 01        ! Day
   NL%IYEARA   = 1500   ! Year
   NL%ITIMEA   = 0000      ! UTC

!----- End of simulation ------------------------------------------------------------------!

   NL%IMONTHZ  = 01 ! Month
   NL%IDATEZ   = 01       ! Day
   NL%IYEARZ   = 2009  ! Year
   NL%ITIMEZ   = 0000     ! UTC
!------------------------------------------------------------------------------------------!



!------------------------------------------------------------------------------------------!
! Main time step parameters                                                                !
!------------------------------------------------------------------------------------------!

   NL%DTLSM  =  240.     ! Basic time step [s].  In the Euler scheme, this
                         ! is the length of the Euler time step.  Recommended
                         ! values are between 60-180.  In the Runge Kutta
                         ! scheme, this is the time between photosynthesis
                         ! updates.  Recommended value is 900.

   NL%RADFRQ  = 240.     ! Frequency at which to update radiation. [s]
!------------------------------------------------------------------------------------------!


 
!------------------------------------------------------------------------------------------!
! Specify the grid cells for which you want to run ED.                                     !
!------------------------------------------------------------------------------------------!

!---- ED Region dimensions ----------------------------------------------------------------!
   NL%N_ED_REGION   =  0  ! number of regions for which you want to run ED. 
                          ! This can be zero provided that N_POI is not...
                          
   NL%GRID_TYPE     =  1  !  0 corresponds to a lat/lon grid.  
                          !  1 corresponds to the polar-stereographic
                          !    In the future, we will also have polygons.

!----- For ED_regions using Lat/Lon grid only: --------------------------------------------!
   NL%GRID_RES      =  1.0          ! This is the grid resolution scale in degrees. [\*/]
                                    !
   NL%ED_REG_LATMIN  =  -12.0, -7.5, 10.0,  -6.0 ! List of minimum latitudes;
   NL%ED_REG_LATMAX  =    1.0, -3.5, 15.0,  -1.0 ! List of maximum latitudes;
   NL%ED_REG_LONMIN  =  -66.0,-58.5, 70.0, -63.0 ! List of minimum longitudes;
   NL%ED_REG_LONMAX  =  -49.0,-54.5, 35.0, -53.0 ! List of maximum latitudes;

!----- For Polar-stereographic, need to define the following variables instead: -----------!
   NL%NNXP = 110                  ! Number of points in the X direction
   NL%NNYP = 70                   ! Number of points in the Y direction
                                  !
   NL%DELTAX   = 60000.           ! X and Y grid spacing scale  [\*/]
   NL%DELTAY   = 60000.           ! in metres (dimension 1)     [\*/]
                                  !
   NL%POLELAT  = -2.609075         ! Latitude of pole point   (dimension 1)
   NL%POLELON  = -60.2093         ! Longitude of pole point  (dimension 1)
                                  !
   NL%CENTLAT  = -2.609075         ! Latitude of central point  (n_ed_regions)
   NL%CENTLON  = -60.2093         ! Longitude of central point (n_ed_regions)

!----- For both kinds of region
   NL%NSTRATX = 1,4 ! Fraction of the sizes given above that I should use for these
   NL%NSTRATY = 1,4 ! regions. The variables affected are denoted by [\*/]

!----- You can pinpoint individual locations, known as POI. -------------------------------!
   NL%N_POI    =    1   ! number of polygons of interest (POIs).  This could be zero.
                
   NL%POI_LAT  = -2.609075  ! list of the latitudes of the POIs (degrees north)
   NL%POI_LON  = -60.2093   ! list of the longitudes of the POIs (degrees east)

   NL%POI_RES  = 1.00       ! grid resolution for POIs (degrees)
                            ! This is used only to define the soil types.
!------------------------------------------------------------------------------------------!

!------------------------------------------------------------------------------------------!
!  Load balancing method                                                                   !
!------------------------------------------------------------------------------------------!

   NL%LOADMETH  = 0    ! Typical either 0 or 2, unecessary to set 1 or 3
                       ! 0 - Let the loadmaster determine
                       !        what is best
                       ! 1 - Load (defined by the polygon vector "workload"
                       !     will be evenly distributed accross 
                       !        the nodes. (good for npoly > nmach )
                       ! 2 - Try to load an equal number of polygons
                       !        per node (good for npoly = nmach)
                       ! 3 - Similar to 1, but here we round the index 
                       !        instead of finding the next integer
!------------------------------------------------------------------------------------------!



!------------------------------------------------------------------------------------------!
! Analysis/history file output                                                             !
!------------------------------------------------------------------------------------------!
 
   NL%IFOUTPUT  =  0            ! Instantaneous analysis (site average)
   NL%IDOUTPUT  =  0            ! Daily means (site average)
   NL%IMOUTPUT  =  3            ! Monthly means (site average)
   NL%IQOUTPUT  =  0            ! Monthly mean of the diurnal cycle
                                !    If this option is on, then FRQFAST must be set 
                                !    in seconds and be less than one day, otherwise, 
                                !    the model won't run.
   NL%IYOUTPUT  =  0            ! Annual output
   NL%ITOUTPUT  =  0            ! Instantaneous fluxes (site average)
                                ! single annual file, no patch/cohort, for optimization or 
                                !     flux tower comparision 
   NL%ISOUTPUT  =  3            ! History files
                                ! 0 - no file;
                                ! 1 - save ascii (deprecated);
                                ! 2 - save RAMS-vfm file (deprecated);
                                ! 3 - save HDF5;
   
   
   NL%ATTACH_METADATA = 0       ! Flag for attaching metadata to HDF datasets
	                        ! Attaching metadata will aid new users
	                        ! in quickly identifying dataset descriptions
	                        ! but will compromise I/O performance significantly
        	                ! 0 = no metadata, 1 = yes metadata

   NL%UNITFAST   = 2             ! Units for FRQFAST/OUTFAST
   NL%UNITSTATE  = 3             ! Units for FRQSTATE/OUTSTATE
                                 ! 0 - Seconds;
                                 ! 1 - Days;
                                 ! 2 - Calendar months (variable)
                                 ! 3 - Calendar years  (variable)
                                 ! PS: If OUTFAST/OUTSTATE are set to special flags
                                 !     (-1 or -2) unitfast/unitstate will be ignored for
                                 !     them

   NL%OUTFAST    = 1.           ! Time interval between analysis files
   NL%OUTSTATE   = 1.           ! Time interval between history files
                                ! Values are in seconds and must be <= 1 month
                                ! Values < FRQFAST/FRQSTATE are set to those values
                                ! Special values: -1 = daily; -2 = monthly
                                ! If OUTFAST/STATE is greater than FRQFAST/STATE then
                                !    multiple timepoints can be recorded to a single file
                                !    reducing the number of files and i/o time in post-
                                !    processing.  Multiple timepoints should be avoided
                                !    in the history files if you intend to use these for
                                !    HISTORY runs as it hasn't been tested.

   NL%ICLOBBER  = 1             ! 0 = stop if files exist, 1 = overwite files
   NL%FRQFAST   = 1.         ! Time interval between analysis/history files
   NL%FRQSTATE  = 1.         ! Time interval between history files

!------------------------------------------------------------------------------------------!



!------------------------------------------------------------------------------------------!
! Analysis/history/restart file: path, prefix, settings                                    !
!------------------------------------------------------------------------------------------!
   NL%FFILOUT = '/n/moorcroftfs1/nlevine/WaterStress/m34/TEST/analy/m34'         ! Analysis output prefix
   NL%SFILOUT = '/n/moorcroftfs1/nlevine/WaterStress/m34/TEST/histo/m34'         ! History output prefix

   !---------------------------------------------------------------------------------------!
   ! IED_INIT_MODE determines how the ecosystem should be initialized.                     !
   !-1 -
   ! 0 - Start from near-bare ground (only a few seedling from every PFT included in this  !
   !     run).                                                                             !
   ! 1 - This will use history files from ED-1.0 to initialise the ecosystem state (like   !
   !     biomass, LAI, plant density, etc.), but starting the thermodynamic state as a     !
   !     new simulation.                                                                   !
   ! 2 - Same as 1, but using history files from ED-2.0 without multiple sites.            !
   ! 3 - Same as 1, but using history files from ED-2.0 with multiple sites.               !
   ! 4 - Same as 1, but using ED2.1 H5 history/state files that take the form:             !
   !     'dir/prefix-gxx.h5'                                                               !
   !     Initialization files MUST end with -gxx.h5 where xx is a two digit integer grid   !
   !     number.  Each grid has its own initialization file.  As an example, if a user has !
   !     two files to initialize their grids with:                                         !
   !     example_file_init-g01.h5 and example_file_init-g02.h5                             !
   !     NL%SFILIN = 'example_file_init'                                                   !
   !                                                                                       !
   ! 5 - This is similar to option 4, except that you may provide several files (including !
   !     a mix of regional and POI runs, each file ending at a different date).  This will !
   !     not check date nor grid structure, it will simply read all polygons and match the !
   !     nearest neighbour to each polygon of your run.  SFILIN must have the directory    !
   !     common to all history files that are sought to be used, up to the last character  !
   !     the files have in common.  For example if your files are                          !
   !     /mypath/P0001-S-2000-01-01-000000-g01.h5,                                         !
   !     /mypath/P0002-S-1966-01-01-000000-g02.h5,                                         !
   !     ...                                                                               !
   !     /mypath/P1000-S-1687-01-01-000000-g01.h5:                                         !
   !     NL%SFILIN = '/mypath/P'                                                           !
   !                                                                                       !
   ! 6 - Initialize with ED-2 style files without multiple sites, exactly like option 2,   !
   !     except that the PFT types are preserved.                                          !
   !                                                                                       !
   ! -1 - use a mix of ED-1 and ED-2 files. This should                                    !
   !      be avoided by all means, unless you are                                          !
   !      absolute sure of what you're doing;                                              !
   !---------------------------------------------------------------------------------------!
   NL%IED_INIT_MODE   = 0

   NL%EDRES  = 1.0                     ! ED2/ED1 restart grid resolution

   NL%SFILIN   = '/n/moorcroft_scratch/nlevine/data/ed2_data/site_bio_data/'

!----- Time of the history start ----------------------------------------------------------!
   NL%ITIMEH   = 0000         ! UTC
   NL%IDATEH   = 01           ! Day
   NL%IMONTHH  = 01   ! Month
   NL%IYEARH   = 1500    ! Year
!------------------------------------------------------------------------------------------!



!------------------------------------------------------------------------------------------!
!  Soil/Surface water variables                                                            !
!------------------------------------------------------------------------------------------!

   NL%NZG = 16       ! Number of soil layers
   NL%NZS = 4           ! Maximum number of snowcover layers

   NL%ISOILFLG = 2      ! Options are: 1. Read from LAT/LON
                        !              2. Constant default soil
                        ! This variable must be defined for all grids. The order is
                        ! all ED regions first followed by ED SOIs. 
   
   NL%NSLCON   =  8      ! Default soil type if ISOILFLG = 2 (choices below:)
   !-----------------------------------------------------------------------!
   ! ED Soil classes:                                                      !
   !-----------------------------------------------------------------------!
   !   1 -- sand            |  2 -- loamy sand    |  3 -- sandy loam       !
   !   4 -- silt loam       |  5 -- loam          |  6 -- sandy clay loam  !
   !   7 -- silty clay loam |  8 -- clayey loam   |  9 -- sandy clay       !
   !  10 -- silty clay      | 11 -- clay          | 12 -- peat             !
   !  13 -- bedrock         | 14 -- silt          | 15 -- heavy clay       !
   !  16 -- clayey sand     | 17 -- clayey silt   |                        !
   !-----------------------------------------------------------------------!

   !---------------------------------------------------------------------------------------!
   !    Prescribed fraction of clay and sand.  This is used only when ISOIFLG is set to 2, !
   ! and slxclay and slxsand are defined between 0 and 1, with the sum of these variables  !
   ! not exceeding 1.  Otherwise, the default ED parameters will be used.                  !
   !---------------------------------------------------------------------------------------!
   NL%SLXCLAY = 0.68
   NL%SLXSAND = 0.20
   !---------------------------------------------------------------------------------------!



   !---------------------------------------------------------------------------------------!
   !    Soil grid and initial conditions if no file is provided:                           !
   !                                                                                       !
   ! SLZ     - soil depth in m.  Values must be negative and go from the deepest layer to  !
   !           the top.                                                                    !
   ! SLMSTR  - this is the initial soil moisture, now given as the soil moisture index.    !
   !           Values can be fraction, in which case they will be linearly interpolated    !
   !           between the special points (e.g. 0.5 will put soil moisture half way        !
   !           between the wilting point and field capacity).                              !
   !              -1 = dry air soil moisture                                               !
   !               0 = wilting point                                                       !
   !               1 = field capacity                                                      !
   !               2 = porosity (saturation)                                               !
   ! STGOFF  - initial temperature offset (soil temperature = air temperature + offset)    !
   !---------------------------------------------------------------------------------------!
   NL%SLZ     = -8.000, -6.959, -5.995, -5.108, -4.296, -3.560, -2.897, -2.307,
                -1.789, -1.340, -0.961, -0.648, -0.400, -0.215, -0.089, -0.020
   NL%SLMSTR  =   1.00,   1.00,   1.00,   1.00,   1.00,   1.00,   1.00,   1.00,
                  1.00,   1.00,   1.00,   1.00,   1.00,   1.00,   1.00,   1.00
   NL%STGOFF  =   0.00,   0.00,   0.00,   0.00,   0.00,   0.00,   0.00,   0.00,
                  0.00,   0.00,   0.00,   0.00,   0.00,   0.00,   0.00,   0.00
   !---------------------------------------------------------------------------------------!



!------------------------------------------------------------------------------------------!
!  Input databases                                                                         !
!------------------------------------------------------------------------------------------!

   !---------------------------------------------------------------------------------------!
   !  Input databases                                                                      !
   !  VEG_DATABASE    - vegetation database, used only to determine the land/water mask.   !
   !                    Fill with the path and the prefix.                                 !
   !  SOIL_DATABASE   - soil database, used to determine the soil type.  Fill with the     !
   !                    path and the prefix.                                               !
   !  LU_DATABASE     - land-use change disturbance rates database, used only when         !
   !                    IANTH_DISTURB is set to 1.  Fill with the path and the prefix.     !
   !  PLANTATION_FILE - plantation fraction file.  In case you don't have such a file or   !
   !                    you do not want to use it, you must leave this variable empty:     !
   !                    (NL%PLANTATION_FILE = ''                                           !
   !  THSUMS_DATABASE - input directory for chd and dgd (not sure for what this is used).  !
   !---------------------------------------------------------------------------------------!
   NL%VEG_DATABASE      = '/n/Moorcroft_Lab/Lab/data/ed2_data/oge2OLD/OGE2_'
   NL%SOIL_DATABASE     = '/n/Moorcroft_Lab/Lab/data/ed2_data/soil_ed22/Quesada+RADAM+IGBP/Quesada+RADAM+IGBP_'
   NL%LU_DATABASE       = '/n/Moorcroft_Lab/Lab/data/ed2_data/land_use/glu/glu-'
   NL%PLANTATION_FILE   = ''
   ! NL%PLANTATION_FILE = '/n/Moorcroft_Lab/Lab/data/ed2_data/land_use/fraction.plantation'
   NL%THSUMS_DATABASE   = '/n/Moorcroft_Lab/Lab/data/ed2_data/ed_inputs/'
   !---------------------------------------------------------------------------------------!

   !----- File containing information for meteorological drivers --------------------------!
   NL%ED_MET_DRIVER_DB = '/n/moorcroft_scratch/nlevine/data/ed2_data/site_met_driver/Manaus_KM34/Manaus_KM34_HEADER'

   NL%SOILSTATE_DB='/n/Moorcroft_Lab/Lab/data/ed2_data/ed_inputs/STW1996OCT.dat'
   NL%SOILDEPTH_DB='/n/Moorcroft_Lab/Lab/data/ed2_data/ed_inputs/soil_depths.dat'

   NL%ISOILSTATEINIT = 0  ! 0 -- use slmstr
                          ! 1 -- read from file

   NL%ISOILDEPTHFLG  = 0  ! 0 -- use NZG, SLZ for each grid cell
                          ! 1 -- read file to get soil depth for each grid cell

   NL%ISOILBC        = 1  ! Soil boundary condition at lowest soil level
                          ! 0 - Bedrock.  No downward flow out of the bottom layer.
                          ! 1 - Free drainage (gravitational flow).
                          ! 2 - Super drainage (layer beneath permanently dry).
                          ! 3 - Assume layer beneath at field capacity.
                          ! 4 - Aquifer.  Assume layer beneath to be permanently saturated.
!------------------------------------------------------------------------------------------!



!------------------------------------------------------------------------------------------!
! ED model options                                                                         !
!------------------------------------------------------------------------------------------!

   NL%INTEGRATION_SCHEME = 1  ! This determines how the fast time step
                              ! is integrated:
                              !  0  --  Euler step
                              !  1  --  Fourth-order Runge Kutta
                              !  2  --  Heun's method (second-order Runge-Kutta)

   NL%RK4_TOLERANCE  = 0.001  ! This is the relative tolerance for Runge-Kutta or Heun's
                              !   integration.  Larger numbers will make runs go faster, 
                              !   at the expense of being less accurate.  Currently the 
                              !   valid range is between 1.e-7 and 1.e-1, but recommended
                              !   values are between 1.e-4 and 1.e-2

   NL%IBRANCH_THERMO = 0      ! This determines whether branches should be included in
                              !    the vegetation thermodynamics or not.  This is under
                              !    development, not fully tested.
                              !  0  --  No branches in energy/radiation;
                              !  1  --  Use Conijn (1995) numbers;
                              !  2  --  Use parameterization from Jarvela (2004);

   !---------------------------------------------------------------------------------------!
   !    NL%IPHYSIOL.  This variable will determine the functional form that will control   !
   ! how the various parameters will vary with temperature, and how the CO2 compensation   !
   ! point for gross photosynthesis (Gamma*) will be found.  Options are:                  !
   !                                                                                       !
   ! 0 -- Original ED-2.1, we use the "Arrhenius" function as in Foley et al. (1996) and   !
   !      Moorcroft et al. (2001).  Gamma* is found using the parameters for tau as in     !
   !      Foley et al. (1996).                                                             !
   ! 1 -- Modified ED-2.1.  In this case Gamma* is found using the Michaelis-Mentel        !
   !      coefficients for CO2 and O2, as in Farquhar et al. (1980) and in CLM.            !
   ! 2 -- Collatz et al. (1991).  We use the power (Q10) equations, with Collatz et al.    !
   !      parameters for compensation point, and the Michaelis-Mentel coefficients.  The   !
   !      leaf respiration correction for high and low temperatures are the same as in     !
   !      Moorcroft et al. (2001), but the correction for Vm is done like in Collatz.      !
   ! 3 -- Same as 2, except that we find Gamma* as in Farquhar et al. (1980) and in CLM.   !
   !---------------------------------------------------------------------------------------!
   NL%IPHYSIOL = 2
   !---------------------------------------------------------------------------------------!

   NL%ISTOMA_SCHEME   = 0     ! This is the scheme used to compute stomatal 
                              ! conductance and photosynthesis.  Set to 0 to do 
                              ! the full, exact calculation each time.  Set to 1 
                              ! to do the 'small perturbation' scheme.

   NL%IALLOM          = 2     ! Which allometry to use (this affects tropical PFTs only)
                              !  0 -- original ED-2.1
                              !  1 -- Baker et al. (2004), equation 2, keeping the same
                              !       balive:bdead ratio
                              !  2 -- Baker et al. (2004), equation 2, keeping the same
                              !       balive as in ED-2.1
                              !  3 -- Same as 2, but using a DBH-> Root depth equation
                              !       based on Kenzo et al. (2009)
                              !  4 -- Same as 2, but with an experimental root depth
                              !       that makes canopy trees to have root depths of 5m
                              !       and grasses/seedlings at 0.5 to have root depth of
                              !       0.5 m 

   !---------------------------------------------------------------------------------------!
   !     The following variable controls the phenology scheme.  Even within each scheme,   !
   ! the actual phenology will be different depending on the PFT.                          !
   !                                                                                       !
   ! -1: grasses   - evergreen;                                                            !
   !     tropical  - evergreen;                                                            !
   !     conifers  - evergreen;                                                            !
   !     hardwoods - cold-deciduous (Botta et al.);                                        !
   !                                                                                       !
   !  0: grasses   - drought-deciduous (old scheme);                                       !
   !     tropical  - drought-deciduous (old scheme);                                       !
   !     conifers  - evergreen;                                                            !
   !     hardwoods - cold-deciduous;                                                       !
   !                                                                                       !
   !  1: prescribed phenology                                                              !
   !                                                                                       !
   !  2: grasses   - drought-deciduous (new scheme);                                       !
   !     tropical  - drought-deciduous (new scheme);                                       !
   !     conifers  - evergreen;                                                            !
   !     hardwoods - cold-deciduous;                                                       !
   !                                                                                       !
   !  3: grasses   - drought-deciduous (new scheme);                                       !
   !     tropical  - drought-deciduous (light phenology);                                  !
   !     conifers  - evergreen;                                                            !
   !     hardwoods - cold-deciduous;                                                       !
   !                                                                                       !
   !  Old scheme: plants shed their leaves once instantaneous amount of available water    !
   !              becomes less than a critical value.                                      !
   !  New scheme: plants shed their leaves once a 10-day running average of available      !
   !              water becomes less than a critical value.                                !
   !---------------------------------------------------------------------------------------!
   NL%IPHEN_SCHEME    = 2
   !---------------------------------------------------------------------------------------!
  
   NL%RADINT          = -11.3868
   NL%RADSLP          = 0.0824
   
   NL%REPRO_SCHEME    = 1     ! This specifies the reproduction scheme:
                              !  0 -- reproduction off (useful for short runs)
                              !  1 -- original ED1 default.  Seeds are exchanged between
                              !       patches belonging to the same site, but they can't
                              !       go outside their original site.
                              !  2 -- similar to 1, but now seeds are exchanged between
                              !       patches belonging to the same polygon, even if they
                              !       are in different sites.  They can't go outside their
                              !       original polygon, though.

   NL%LAPSE_SCHEME    = 0     ! This specifies the met lapse rate scheme:
                              !  0 -- lapse rates off
                              !  1 -- phenomenological, global
                              !  2 -- phenomenological, local (not yet implemented)
                              !  2 -- mechanistic(not yet implemented)
  
   NL%CROWN_MOD       = 1     ! Specifies how tree crowns are represent in the 
                              ! canopy radiation model
                              !  0  - ED1 default (continuous horizontal)
                              !  1  - finite radius mixing model (Dietze)
                              !  2  - finite radius with horizontal competition for
                              !       light (radiation is solved layer by layer rather
                              !       than cohort by cohort).  This is still under
                              !       development, ideas are welcome.

   !---------------------------------------------------------------------------------------!
   ! ICAN_SWRAD -- This variable specifies which canopy radiation model to use for short-  !
   !               wave radiation within the canopy:                                       !
   !               0.  Beers law.  Added back just for theroretical tests, don't use it if !
   !                   you are unsure.  This cannot be used with CROWN_MOD = 2.            !
   !               1.  Two-stream model.  The default and recommended method.              !
   !                                                                                       !
   !               In either case longwave will be solved using two-stream model.          !
   !---------------------------------------------------------------------------------------!
   NL%ICAN_SWRAD      = 1
   !---------------------------------------------------------------------------------------!

   NL%DECOMP_SCHEME   = 0     ! Specifies soil decomposition temperature dependence
                              ! 0 -- original exponential
                              ! 1 -- Lloyd and Taylor (1994) model
                              !      [[requires parameters to be set in xml]]

   NL%H2O_PLANT_LIM   = 1     ! Determines whether plant photosynthesis can be limited 
                              ! by water
                              !
                              ! 0 -- No water limitation
                              !      FSW = 1           
                              ! 1 -- Original ED-1.0/ED-2.0 method
                              !      FSW = 1/ (1 + D/S)
                              ! 2 -- Alternative method based on CLM, uses water potential,
                              !      but ignores the root biomass.

   !---------------------------------------------------------------------------------------!
   !    These are factors that multiply some of the ED-2.1 default parameters.  Setting    !
   ! them to 1.0 will make them the default.  These are applied for all PFTs.              !
   !---------------------------------------------------------------------------------------!
   NL%VMFACT          = 1.6   ! Factor for changing Vm0 from the default
   NL%MFACT           = 1.125 ! Factor for changing stomatal slope (M)
   NL%KFACT           = 3.    ! Factor for changing the water conductance (Kw)
   NL%GAMFACT         = 0.75  ! Factor for changing the dark respiration factor (gamma)
   NL%D0FACT          = 1.00  ! Factor for changing the transpiration control (D0)
   NL%ALPHAFACT       = 1.00  ! Factor for changing the quantum yield of C3 plants
                              !     This is only applied when QUANTUM_EFFICIENCY_T is 0
   NL%THETACRIT       = 0.20  ! Leaf drought phenology threshold.  This is the relative 
                              !     soil moisture above the wilting point below which the
                              !     drought-deciduous plants will start shedding their 
                              !     leaves
   NL%LWFACT          = 1.    ! Factor for changing the leaf width factor (w)
   NL%THIOFF          = 0.    ! Offset to be added to the Vm_high_temp
   NL%GGFACT          = 1.    ! Factor to multiply the ground to canopy conductancd
   !---------------------------------------------------------------------------------------!

   NL%QUANTUM_EFFICIENCY_T = 0 ! Which quantum efficiency should I use
                              ! 0 ---- original ED-2.1
                              ! 1 ---- Temperature dependent quantum efficiency after 
                              !        Ehleringer (1978)
   
   NL%N_PLANT_LIM     = 0     ! Determines whether plant photosynthesis can be 
                              ! limited by nitrogen
                              !
                              ! 0 -- No nitrogen limitation
                              ! 1 -- Nitrogen limitation model

   NL%N_DECOMP_LIM    = 0     ! Determines whether (1) or not (0) decomposition
                              ! can be limited by nitrogen

   NL%INCLUDE_FIRE    = 2     ! Determines how to apply fire in the model:
                              ! 0. No fires;
                              ! 1. (deprecated) Fire will be triggered with enough biomass 
                              !    and integrated ground water depth less than a threshold.
                              !    Based on ED-1, the threshold assumes that the soil is 
                              !    1 m, so deeper soils will need to be much drier
                              !    to allow fires to happen and often will never allow 
                              !    fires. 
                              ! 2. Fire will be triggered with enough biomass and the
                              !    total soil water at the top 75 cm falls below a 
                              !    threshold. 

   NL%SM_FIRE         = 0.11  ! Threshold to define the relative soil moisture of the top 
                              !    75cm that will trigger fires.  Used only when 
                              !    include_fire is set to 2.


   NL%IANTH_DISTURB   = 0     ! Flag specifying whether (1) or not (0) to include
                              ! anthropogenic disturbances such as agriculture, 
                              ! abandonment, and harvesting.

   NL%ICANTURB        = 0     ! Canopy roughness scheme
                              !  0. Based on Leuning et al. (1995), wind is computed using
                              !     the similarity theory for the top cohort, and they are
                              !     extinguished with cumulative LAI.  The only difference 
                              !     is that we use local LAI and average by crown area.
                              !  1. is the default ED-2.1 scheme, except that it uses the 
                              !     zero-plane displacement height. 
                              !  2. This uses the method of Massman (1997) using constant
                              !     drag and no sheltering. 
                              !  3. Similar to 2, but it uses a second-order closure based
                              !     on Massman and Weil (1999)

   NL%I_BLYR_CONDCT   = 0     ! Methods to estimate the leaf boundary layer conductance:
                              !  0. The Nusselt number for forced convection is estimated
                              !     using the average winds, with no corrections
                              !  1. The actual Nusselt number for forced convection is 
                              !     multiplied by 2.5 as the Reynolds number gets close or
                              !     greater than 10,000.
                              !  2. The actual Nusselt number for forced convection is 
                              !     multiplied by 10. as the Reynolds number gets close or
                              !     greater than 10,000.



   NL%ISFCLYRM        = 3     ! Surface layer model (used to compute ustar, tstar,...)
                              ! This variable controls the SLM for both LEAF and ED.
                              !  1 - BRAMS default, based on Louis (1979)
                              !      It uses empirical relations to estimate the flux
                              !      based on the bulk Richardson number
                              !  2 - Oncley and Dudhia (1995) model, based on MM5.
                              !      It uses a empirical relation between bulk Richardson
                              !      number and z/L, then computes the flux functions
                              !  3 - Beljaars and Holtslag (1991) model. Similar to 2, but
                              !      it finds z/L using a root-finding method, and it has a 
                              !      different parametrisation for stable layers that
                              !      works better during night time.
                              !  4 - The parametrisation of Beljaars and Holtslag, but 
                              !      using z/L estimation as in Oncley and Dudhia. 
                              !  5 - The parametrisation of Oncley and Dudhia, but 
                              !      using z/L estimation as in Beljaars and Holtslag. 

   NL%IED_GRNDVAP   = 0       ! Methods to find the ground -> canopy conductance:
                              ! In all cases the beta term is modified so it approaches
                              !    zero as soil moisture goes to dry air soil. 
                              !  0. Modified Lee Pielke (1992), adding field capacity, but 
                              !     using beta factor without the square, like in 
                              !     Noilhan and Planton (1989).  This is the closest to
                              !     the original ED-2.0
                              !  1. Test # 1 of Mahfouf and Noilhan (1991)
                              !  2. Test # 2 of Mahfouf and Noilhan (1991)
                              !  3. Test # 3 of Mahfouf and Noilhan (1991)
                              !  4. Test # 4 of Mahfouf and Noilhan (1991)

   !---------------------------------------------------------------------------------------!
   !     The following variables are used only when ISFCLYRM is not 1.                     !
   !---------------------------------------------------------------------------------------!
   NL%GAMM            = 13.   ! Momentum coefficient
   NL%GAMH            = 13.   ! Heat coefficient
   NL%TPRANDTL        = 0.74  ! Turbulent Prandtl number
   NL%VH2VR           = 0.13  ! Vegetation Roughness: Vegetation height ratio
   NL%VH2DH           = 0.63  ! Displacement height : vegetation height ratio
   NL%RIBMAX          = 1.00  ! Maximum bulk Richardson number (ignored if ISFCLYRM = 1)
   NL%LEAF_MAXWHC     = 0.11  ! Maximum water that can be intercepted          [ kg/m2leaf]
   !---------------------------------------------------------------------------------------!

   NL%IPERCOL         = 0     ! Percolation scheme:
                              !  0 - Original method, from LEAF-3.  Shed liquid in excess 
                              !      of a 1:9 liquid-to-ice ratio through percolation.
                              !  1 - Alternative "free" water calculation.  
                              !      Anderson (1976), NOAA Tech Report NWS 19.
                              !  2 - Same as 1, but we also apply conductivity profile
                              !      (decreases with depth even for constant soil moisture)
   !--------------------------------------------------------------------!
   ! PLANT FUNCTIONAL TYPES (PFTs):                                     !
   !--------------------------------------------------------------------!
   ! 1 - C4 grass                    |  7 - southern pines              !
   ! 2 - early tropical              |  8 - late conifers               !
   ! 3 - mid tropical                |  9 - early temperate deciduous   !
   ! 4 - late tropical               | 10 - mid temperate deciduous     !
   ! 5 - C3 grass                    | 11 - late temperate deciduous    !
   ! 6 - northern pines              |                                  !
   !--------------------------------------------------------------------!
   NL%INCLUDE_THESE_PFT = 1,2,3,4       ! List of PFTs to be included 
   NL%AGRI_STOCK        = 1             ! Agriculture PFT (used only if ianth_disturb=1)
   NL%PLANTATION_STOCK  = 3             ! Plantation PFT  (used only if ianth_disturb=1)

   NL%PFT_1ST_CHECK = 0 ! What should I do when I find a cohort with an unexpected PFT 
                        !    in the history start?
                        ! 0. Stop the run;
                        ! 1. Add the PFT in the INCLUDE_THESE_PFT list;
                        ! 2. Ignore the cohort.
                        !
                        ! This option is ignored in near bare ground runs.

!----- Site, patch and cohort dimension settings ------------------------------------------!
   NL%MAXSITE   =   6       ! This is the strict maximum number of sites that each polygon
                            !    can contain.  Currently this is used only when the user 
                            !    wants to run the same polygon with multiple soil types.  
                            !    If there aren't that many different soil types with a
                            !    minimum area (check MIN_SITE_AREA below), then the model 
                            !    will allocate just the amount needed.
   NL%MAXPATCH  =  20       ! If number of patches in a given site exceeds NL%MAXPATCH, 
                            !    force patch fusion.  If NL%MAXPATCH is 0, then
                            !    fusion will never happen.  If MAXPATCH is negative, then 
                            !    the absolute value is used only during the initialization, 
                            !    and fusion will never happen again. 
   NL%MAXCOHORT =  80       ! If number of cohorts in a given patch exceeds NL%MAXCOHORT, 
                            !    force cohort fusion.  If NL%MAXCOHORT is 0, then
                            !    fusion will never happen.  If MAXCOHORT is negative, then 
                            !    the absolute value is used only during the initialization, 
                            !    and fusion will never happen again. 
   NL%MIN_SITE_AREA = 0.005 ! This is the minimum fraction area of a given soil type that
                            !    allows a site to be created (ignored if IED_INIT_MODE is 
                            !    set to 3).
!------------------------------------------------------------------------------------------!



!------------------------------------------------------------------------------------------!
! Commonly changed parameters                                                              !
!------------------------------------------------------------------------------------------!

   NL%ZROUGH = 0.1                       ! Constant roughness if for all domain

   NL%TREEFALL_DISTURBANCE_RATE  = 0.014 ! - Sign-dependent treefall disturbance rate:
                                         ! > 0. usual disturbance rate, in 1/years;
                                         ! = 0. No treefall disturbance;
                                         ! < 0. Treefall will be added as a mortality
                                         !      rate (it will kill plants, but it won't
                                         !      create a new patch).

   NL%TIME2CANOPY    =     0.0           ! Minimum patch age for treefall disturbance to 
                                         !    happen.  If TREEFALL_DISTURBANCE_RATE = 0.,
                                         !    this value will be ignored. 

   NL%RUNOFF_TIME    = 28800.0           ! the forest could get saturated and 
                                         ! develop a sfcwater pool of meters or 
                                         ! more.  In many cases, this is not realistic.
                                         ! This is the time scale in seconds for 
                                         ! this water to disappear.  If you want no runoff
                                         ! set runoff_time = 0 (not recommended for long 
                                         ! runs).
   NL%BETAPOWER      = 1.0               ! Power to be applied to the beta term that
                                         !     controls the ground evaporation.
   NL%USTMIN         = 0.0100            ! Minimum u* (m/s)
   
!------------------------------------------------------------------------------------------!






   !---------------------------------------------------------------------------------------!
   ! Control parameters for printing to standard output                                    !
   !         Any variable can be printed to standard output.                               !
   !         Choose any variables that are defined in the variable table fill              !
   !         routines in ed_state_vars.f90.  Choose the start and end dimension            !
   !         in the vector that you wish to view.  It can be polygon,site,..whatever       !
   !         This 'should' work in parallel ...                                            !
   !         The output will be printed to the screen at frequency frqanl,                 !
   !         the print call is synchronized with instantaneous file writes,                !
   !         so those variables will have been accumulated and normalized                  !
   !         from their rk4state and be meaningful to view.                                !
   !---------------------------------------------------------------------------------------!

   NL%IPRINTPOLYS  =  0        ! 0 = do not print information to screen
                               ! 1 = print polygon arrays to screen, use variables
                               !     described below
   !----- Print these variables ------------------------------------------!
   NL%PRINTVARS    = 'AVG_PCPG','AVG_CAN_TEMP','AVG_VAPOR_AC','AVG_CAN_SHV'

   !---------------------------------------------------------------------------------------!
   ! Use these format strings:                                                             !
   ! The format strings follow standard fortran format notation. i.e. 'f' is for floating  !
   ! point.  First number is total digits, second number is the number of digits to the    !
   ! left of right of the decimal point.                                                   !
   !---------------------------------------------------------------------------------------!
   NL%PFMTSTR      = 'f10.8','f5.1','f7.2','f9.5'

   NL%IPMIN        = 1       ! The first index to print
   NL%IPMAX        = 60      ! The last index to print
  !----------------------------------------------------------------------------------------!

!------------------------------------------------------------------------------------------!
! Met driver control                                                                       !
!------------------------------------------------------------------------------------------!

   NL%IMETTYPE  = 1           ! 0 = ASCII, 1 = HDF5

   NL%ISHUFFLE  = 0           ! How to choose an year outside the met data range:
                              ! 0. Sequentially cycle over years
                              ! 1. Randomly pick the years, using the same sequence
                              ! 2. Randomly pick the years, choosing a different 
                              !    sequence each time the model is run.

   NL%METCYC1         = 2002  ! First year of met data
   NL%METCYCF         = 2005  ! Last year of met data

   NL%IMETAVG         = 0     ! Type of average of the input fluxes:
                              ! 0 -- No average, the values are instantaneous
                              ! 1 -- Averages ending at the reference time
                              ! 2 -- Averages beginning at the reference time
                              ! 3 -- Averages centred at the reference time

   !---------------------------------------------------------------------------------------!
   ! IMETRAD -- What should the model do with the input short wave radiation?              !
   !            0.  Nothing, use it as is.                                                 !
   !            1.  Add them together, then use the SiB method to break radiation down     !
   !                into the four components (PAR direct, PAR diffuse, NIR direct,         !
   !                NIR diffuse).                                                          !
   !            2.  Add then together, then use the method by Weiss and Norman (1985) to   !
   !                break radiation down to the four components.                           !
   !            3.  Gloomy -- All radiation goes to diffuse.                               !
   !            4.  Sesame street -- all radiation goes to direct, except at night.        !
   !---------------------------------------------------------------------------------------!
   NL%IMETRAD         = 0
   !---------------------------------------------------------------------------------------!

   NL%INITIAL_CO2     = 278.0 ! Initial value for CO2 in case no CO2 is provided at the 
                              ! meteorological driver dataset


!----- For phenology prescribed from observations, we also need to recycle over years. ----!
   NL%IPHENYS1 = 1992 ! initial year for spring
   NL%IPHENYSF = 2003 ! final year for spring
   NL%IPHENYF1 = 1992 ! initial year for fall
   NL%IPHENYFF = 2003 ! final year for fall
   NL%PHENPATH   = '/n/moorcroft_data/data/ed2_data/phenology/phenology'
!------------------------------------------------------------------------------------------!



!------------------------------------------------------------------------------------------!
! XML configuration file                                                                   !
!------------------------------------------------------------------------------------------!
   NL%IEDCNFGF   = 'config.xml'
   NL%EVENT_FILE = 'myevents.xml'
!------------------------------------------------------------------------------------------!



!-------------------------------------------------------------------------!
! Optimization configuration. (Currently not used)                        !
!-------------------------------------------------------------------------!
   NL%IOPTINPT = ''   ! Directory for optimizer inputs
!-------------------------------------------------------------------------!

/ ! end of ED_NL
